(function(e){var t=e.$,n=e.kureicp;n.mobile.APIcoop="/coophall/qprojlist?",n.mobile.config={lotId:0,issue:0,sortIndex:6,page:1},n.mobile.levelImg=[],n.mobile.toCoopLevel=function(e,t){return[Math.floor(e/t),e%t]},n.mobile.coopLevel=function(e){var t=[],r=[],i=[],s=[];if(e>0){var o=(e+"").length;o>=4?(t=n.mobile.toCoopLevel(e,1e3),t[0]>10&&(t[0]=10),n.mobile.levelImg.push('<span class="icon-award crown'+t[0]+'"></span>'),n.mobile.coopLevel.call(null,t[1])):o==3?(r=n.mobile.toCoopLevel(e,100),n.mobile.levelImg.push('<span class="icon-award cup'+r[0]+'"></span>'),n.mobile.coopLevel.call(null,r[1])):o==2?(i=n.mobile.toCoopLevel(e,10),n.mobile.levelImg.push('<span class="icon-award medal'+i[0]+'"></span>'),n.mobile.coopLevel.call(null,i[1])):(s=n.mobile.toCoopLevel(e,1),n.mobile.levelImg.push('<span class="icon-award star'+s[0]+'"></span>'))}return n.mobile.levelImg.join("")},n.mobile.AsynDownData=function(){var e=t("#setting"),r=t("#coops"),i=t("#countdowm"),s=e.attr("lotId"),o=n.string.getUrlParam("issue"),u=t("#navtit");u.html(u.text()+'<span class="head-arr"><em></em></span>');var a=t(".btn-load");n.mobile.config.lotId=s,n.mobile.config.page=1,n.mobile.config.issue=o,t.getJSON(n.mobile.APIcoop+n.mobile.fetchQuery()+"rnd="+Math.random(),function(e){if(e){var o=e.lotInfo,u=e.issueList,f=[],l=e.qissue,c=e.curIssue,h=e.pcount*1;n.mobile.prcount=e.rcount*1;if(o.isSale*1){if(!/^(13004)[123]$/.test(e.lotId)){var p;if(/^(13001)[19]$/.test(e.lotId)){var d=l.replace(/\d{4}/g,"")*1,v=c.replace(/\d{4}/g,"")*1;d>=v?p="\u622a\u6b62\u65f6\u95f4\uff1a"+o.endTime:p="\u8ba4\u8d2d\u5df2\u622a\u6b62"}else l!=c?p="\u8ba4\u8d2d\u5df2\u622a\u6b62":p="\u622a\u6b62\u65f6\u95f4\uff1a"+o.endTime;i.text(p)}}else i.text("\u6682\u505c\u9500\u552e");a.attr("total",h),t("#count").text(n.mobile.prcount),h==1&&a.hide(),r.attr("now",c),t.each(u,function(e,t){var n="",r="";/^(13001)[19]$/.test(s)&&(e<2&&(r="(\u9884\u552e)"),e==2&&(r="(\u5728\u552e)")),t==l&&(n='selected="selected"'),f.push("<option "+n+" value="+t+">"+t+r+"</option>")}),r.append(f.join("")),n.mobile.joinTempate(e.records,"init")}})},n.mobile.joinTempate=function(r,i){var s=t("#coopin"),o=t(".load"),u=r;if(u&&u.length){var a=u.length,f=[],l,c,h,p,d,v,m,g,y,b,w,E;for(var S=0;S<a;S++){var x="",T="",N=u[S];l=N.projId,c=N.userName,h=N.winScore*1,p=n.mobile.coopLevel(h),n.mobile.levelImg=[],d=N.totalMoney*1,v=N.saledCount*1,m=N.saledPercent,g=N.lockCount*1,y=N.lockPercent,b=d-v,w=N.bonusStatus,E=N.setTopFlag*1,g>0&&(x="+"+y+"%\u4fdd"),w?T='\u5956\u3000\u91d1\uff1a<span class="prize">'+w+"</span>":T='\u8fdb\u3000\u5ea6\uff1a<span class="count"><cite style="width:'+m+'%"></cite></span> '+m+"%"+x,f.push('<li><a href="/lotdetails/buycoop/projid/'+l+"/lotid/"+n.mobile.config.lotId+'/"><em></em>'),f.push("<p>\u53d1\u8d77\u4eba\uff1a"+c+" "+p+"</p>"),f.push("<p>\u91d1\u3000\u989d\uff1a"+d+"\u5143 ,\u5269\u4f59"+(d-v)+"\u5143</p>"),f.push("<p>"+T+"</p></a>"),E&&f.push('<span class="hm-top">\u9876</span>'),f.push("</li>")}i=="init"?(s.html(f.join("")),o.remove(),e.scroll(0,0)):s.append(f.join(""))}else s.html('<li class="record-txt">\u6682\u65e0\u8bb0\u5f55</li>'),o.remove()},n.mobile.fetchQuery=function(){var e="",t=n.mobile.config;if(typeof t=="object")for(var r in t)e=e+r+"="+t[r]+"&";return e},n.mobile.initfilter=function(){var e=t("#coopmore"),r=t("#moretxt"),i=r.attr("msg")||"\u5df2\u52a0\u8f7d\u5168\u90e8",s=t("#coops"),o=t(".btn-load");o.on("click",function(){var o=t(this),u=o.attr("total")*1;n.mobile.config.page++,n.mobile.config.page>u?(n.mobile.config.page=u,r.html(i),o.hide()):(e.removeClass("none"),r.html("\u6b63\u5728\u83b7\u53d6..."),s.attr("now")!=s.val()&&(n.mobile.config.issue=s.val(),n.mobile.config.sortIndex=7),t.getJSON(n.mobile.APIcoop+n.mobile.fetchQuery()+"rnd="+Math.random(),function(t){t&&(n.mobile.config.page>=u?(r.html(i),o.hide()):r.html('\u5f53\u524d\u5171\u6709<em id="count" class="red">'+n.mobile.prcount+"</em>\u6761\u65b9\u6848\uff0c\u70b9\u51fb\u52a0\u8f7d\u66f4\u591a"),e.addClass("none"),n.mobile.joinTempate(t.records,"next"))}))})},n.mobile.filterIndex=function(){var e=t("#moretxt"),r=t(".btn-load");t.getJSON(n.mobile.APIcoop+n.mobile.fetchQuery()+"rnd="+Math.random(),function(t){t&&(n.mobile.joinTempate(t.records,"init"),r.show(),e.html('\u5f53\u524d\u5171\u6709<em id="count" class="red">'+n.mobile.prcount+"</em>\u6761\u65b9\u6848\uff0c\u70b9\u51fb\u52a0\u8f7d\u66f4\u591a"))})},n.mobile.eventInit=function(){var r=t("#coops"),i=t("#coopin"),s=t(".btn-lskj"),o=t(".pop-box3"),u=t("#navtit"),a=t(".pop-box3"),f=o.find("a");r.on("change",function(){var n=e.location.href,r=/\?(issue=)+(\d{5,12}|\d{4}-\d{2}-\d{2})/g,i,s=t(this).val();r.test(n)?i=n.replace(r,"")+"?issue="+s:i=n+"?issue="+s,e.location.href=i}),s.on(n.lottery.tap,function(){a.hasClass("none")?a.removeClass("none"):a.addClass("none")}),u.on(n.lottery.tap,function(){var e=t(".head-arr"),n=t(".pop-box2");e.hasClass("head-arron")?(e.removeClass("head-arron"),n.addClass("none")):(e.addClass("head-arron"),n.removeClass("none"))}),i.on("touchstart","li",function(){t(this).addClass("tap")}),i.on("touchend","li",function(){t(this).removeClass("tap")}),f.on("click",function(){var e=t(this),i=e.attr("tabindex")*1;o.find("a").removeClass("btn-pop-on"),e.addClass("btn-pop-on"),n.mobile.config.sortIndex=i,n.mobile.config.page=1,n.mobile.config.issue=r.val(),a.addClass("none"),s.text(e.text()),n.mobile.filterIndex()})},t(function(){n.mobile.AsynDownData(),n.mobile.eventInit(),n.mobile.initfilter()})})(window);