(function(){var $=window.$,Q=window.kureicp;Q.socShare=Q.socShare||{},Q.socShare.array=Q.socShare.array||{},Q.socShare.each=Q.socShare.array.forEach=Q.socShare.array.each=function(e,t,n){if(!e||!e.length)return e;var r,i,s,o=e.length;if("function"==typeof t)for(s=0;s<o;s++){i=e[s],r=t.call(n||e,i,s);if(r===!1)break}return e},Q.socShare.array.find=function(e,t){var n,r,i=e.length;if("function"==typeof t)for(r=0;r<i;r++){n=e[r];if(!0===t.call(e,n,r))return n}return null},Q.socShare.array.indexOf=function(e,t,n){var r=e.length,i=t;n|=0,n<0&&(n=Math.max(0,r+n));for(;n<r;n++)if(n in e&&e[n]===t)return n;return-1},Q.socShare.array.remove=function(e,t){var n=e.length;while(n--)n in e&&e[n]===t&&e.splice(n,1);return e},Q.socShare.dom=Q.socShare.dom||{},Q.socShare.dom.g=function(e){return"string"==typeof e||e instanceof String?document.getElementById(e):e&&e.nodeName&&(e.nodeType==1||e.nodeType==9)?e:null},Q.socShare.g=Q.socShare.G=Q.socShare.dom.g,Q.socShare.dom.getAncestorByTag=function(e,t){e=Q.socShare.dom.g(e),t=t.toUpperCase();while((e=e.parentNode)&&e.nodeType==1)if(e.tagName==t)return e;return null},Q.socShare.event=Q.socShare.event||{},Q.socShare.event.getTarget=function(e){return e.target||e.srcElement},Q.socShare.event._listeners=Q.socShare.event._listeners||[],Q.socShare.lang=Q.socShare.lang||{},Q.socShare.lang.isString=function(e){return"[object String]"==Object.prototype.toString.call(e)},Q.socShare.isString=Q.socShare.lang.isString,Q.socShare.dom._g=function(e){return Q.socShare.lang.isString(e)?document.getElementById(e):e},Q.socShare._g=Q.socShare.dom._g,Q.socShare.event.on=function(e,t,n){t=t.replace(/^on/i,""),e=Q.socShare.dom._g(e);var r=function(t){n.call(e,t)},i=Q.socShare.event._listeners,s=Q.socShare.event._eventFilter,o,u=t;return t=t.toLowerCase(),s&&s[t]&&(o=s[t](e,t,r),u=o.type,r=o.listener),e.addEventListener?e.addEventListener(u,r,!1):e.attachEvent&&e.attachEvent("on"+u,r),i[i.length]=[e,t,n,r,u],e},Q.socShare.event.un=function(e,t,n){e=Q.socShare.dom._g(e),t=t.replace(/^on/i,"").toLowerCase();var r=Q.socShare.event._listeners,i=r.length,s=!n,o,u,a;while(i--)o=r[i],o[1]===t&&o[0]===e&&(s||o[2]===n)&&(u=o[4],a=o[3],e.removeEventListener?e.removeEventListener(u,a,!1):e.detachEvent&&e.detachEvent("on"+u,a),r.splice(i,1));return e},Q.socShare.on=Q.socShare.event.on,Q.socShare.un=Q.socShare.event.un,Q.socShare.lang.module=function(name,module,owner){var packages=name.split("."),len=packages.length-1,packageName,i=0;if(!owner)try{if(!(new RegExp("^[a-zA-Z_$][a-zA-Z0-9_$]*$")).test(packages[0]))throw"";owner=eval(packages[0]),i=1}catch(e){owner=window}for(;i<len;i++)packageName=packages[i],owner[packageName]||(owner[packageName]={}),owner=owner[packageName];owner[packages[len]]||(owner[packages[len]]=module)},Q.socShare.object=Q.socShare.object||{},Q.socShare.extend=Q.socShare.object.extend=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},Q.socShare.string=Q.socShare.string||{},Q.socShare.string.decodeHTML=function(e){var t=String(e).replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&");return t.replace(/&#([\d]+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},Q.socShare.decodeHTML=Q.socShare.string.decodeHTML,function(){var e=new RegExp("(^[\\s\\t\\xa0\\u3000]+)|([\\u3000\\xa0\\s\\t]+$)","g");Q.socShare.string.trim=function(t){return String(t).replace(e,"")}}(),Q.socShare.trim=Q.socShare.string.trim,Q.socShare.dom.remove=function(e){e=Q.socShare.dom.g(e);var t=e.parentNode;t&&t.removeChild(e)},Q.socShare.dom.addClass=function(e,t){e=Q.socShare.dom.g(e);var n=t.split(/\s+/),r=e.className,i=" "+r+" ",s=0,o=n.length;for(;s<o;s++)i.indexOf(" "+n[s]+" ")<0&&(r+=(r?" ":"")+n[s]);return e.className=r,e},Q.socShare.addClass=Q.socShare.dom.addClass,Q.socShare.dom.removeClass=function(e,t){e=Q.socShare.dom.g(e);var n=e.className.split(/\s+/),r=t.split(/\s+/),i,s=r.length,o,u=0;for(;u<s;++u)for(o=0,i=n.length;o<i;++o)if(n[o]==r[u]){n.splice(o,1);break}return e.className=n.join(" "),e},Q.socShare.removeClass=Q.socShare.dom.removeClass,Q.socShare.dom.hasClass=function(e,t){e=Q.socShare.dom.g(e);if(!e||!e.className)return!1;var n=Q.socShare.string.trim(t).split(/\s+/),r=n.length;t=e.className.split(/\s+/).join(" ");while(r--)if(!(new RegExp("(^| )"+n[r]+"( |$)")).test(t))return!1;return!0},Q.socShare.dom.toggleClass=function(e,t){Q.socShare.dom.hasClass(e,t)?Q.socShare.dom.removeClass(e,t):Q.socShare.dom.addClass(e,t)},Q.socShare.sio=Q.sio||{},Q.socShare.sio._createScriptTag=function(e,t,n){e.setAttribute("type","text/javascript"),n&&e.setAttribute("charset",n),e.setAttribute("src",t),document.getElementsByTagName("head")[0].appendChild(e)},Q.socShare.sio._removeScriptTag=function(e){if(e.clearAttributes)e.clearAttributes();else for(var t in e)e.hasOwnProperty(t)&&delete e[t];e&&e.parentNode&&e.parentNode.removeChild(e),e=null},Q.socShare.sio.callByBrowser=function(e,t,n){var r=document.createElement("SCRIPT"),i=0,s=n||{},o=s.charset,u=t||function(){},a=s.timeOut||0,f;r.onload=r.onreadystatechange=function(){if(i)return;var e=r.readyState;if("undefined"==typeof e||e=="loaded"||e=="complete"){i=1;try{u(),clearTimeout(f)}finally{r.onload=r.onreadystatechange=null,Q.socShare.sio._removeScriptTag(r)}}},a&&(f=setTimeout(function(){r.onload=r.onreadystatechange=null,Q.socShare.sio._removeScriptTag(r),s.onfailure&&s.onfailure()},a)),Q.socShare.sio._createScriptTag(r,e,o)},Q.socShare.lang.min=function(e,t){return e<t?e:t},Q.socShare.dom.getPageScrollTop=function(){var e;return window.pageYOffset?e=window.pageYOffset:document.documentElement&&document.documentElement.scrollTop?e=document.documentElement.scrollTop:document.body&&(e=document.body.scrollTop),e},Q.socShare.dom.getPageSize=function(){var e,t;window.innerHeight&&window.scrollMaxY?(e=window.innerWidth+window.scrollMaxX,t=window.innerHeight+window.scrollMaxY):document.body.scrollHeight>document.body.offsetHeight?(e=document.body.scrollWidth,t=document.body.scrollHeight):document.body&&(e=document.body.offsetWidth,t=document.body.offsetHeight);var n,r;window.innerHeight?(n=window.innerWidth,r=window.innerHeight):document.documentElement&&document.documentElement.clientHeight?(n=document.documentElement.clientWidth,r=document.documentElement.clientHeight):document.body&&(n=document.body.clientWidth,r=document.body.clientHeight);var i=e<n?n:e,s=t<r?r:t;return{PageW:i,PageH:s,WinW:n,WinH:r}},Q.socShare.getBrowserInfo=function(){var e={},t=navigator.userAgent.toLowerCase(),n;return(n=t.match(/msie ([\d.]+)/))?e.ie=n[1]:(n=t.match(/firefox\/([\d.]+)/))?e.firefox=n[1]:(n=t.match(/chrome\/([\d.]+)/))?e.chrome=n[1]:(n=t.match(/ucbrowser\/([\d.]+)/))?e.uc=n[1]:(n=t.match(/qqbrowser\/([\d.]+)/))?e.qq=n[1]:(n=t.match(/baidubrowser\/([\d.]+)/))?e.baidu=n[1]:(n=t.match(/zhangbai\/([\d.]+)/))?e.zhangbai=n[1]:(n=t.match(/cyanogenmod\-([\d.]+)/))?e.dolphin=n[1]:(n=t.match(/opera.([\d.]+)/))?e.opera=n[1]:(n=t.match(/version\/([\d.]+).*safari/))?e.safari=n[1]:0,e},Q.socShare.isIPhone=function(){var e=navigator.userAgent.toLowerCase();return!!e.match(/ipad|iphone|ipod/)},Q.socShare.isAndroid=function(){var e=navigator.userAgent.toLowerCase();return e.indexOf("android")>0},Q.socShare.lang.module("Q.socShare.ui",{_stylelink:"/static/v3/css/activity/share.css",_orientTimer:null,_tpl:'<div class="bd-share"><ul class="bd-cl" id="bd_share_mediaes" style="width:<%=listWidth%>;"><%Q.socShare.each(mediaes,function(media,idx){%><li class="media"><a class="<%=media.media_type%>" id="bd_share_mediaes_<%=media.media_type%>" href="<%=href[media.media_type]%>"><%=media.cn%></a></li><%});%></ul></div>',_template:function(e,t){var n={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},r=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},i="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+e.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(n.escape||noMatch,function(e,t){return"',_escape("+unescape(t)+"),'"}).replace(n.interpolate||noMatch,function(e,t){return"',"+unescape(t)+",'"}).replace(n.evaluate||noMatch,function(e,t){return"');"+unescape(t).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",s=new Function("obj","_escape",i);return t?s(t,r):function(e,t){return s.call(this,e,t)}},_addStyle:function(){var e=this,t=document.getElementsByTagName("head")[0],n=document.getElementsByTagName("link"),r=!0;for(var i=0,s=n.length;i<s;i++)if(n[0].href.indexOf(e._stylelink)===0){r=!1;break}if(r){var o=document.createElement("link");o.setAttribute("rel","stylesheet"),o.setAttribute("type","text/css"),o.setAttribute("href",e._stylelink),t.appendChild(o)}},_add_event:function(e){var t=this,n=this._data,r=n.time,i=Q.socShare.g("bd_share_popup_"+r),s=n.theme==="native"&&n.animate!==!1;t._viewOrientHandler=function(e){t._orient()},t._shareBtnClickHandler=function(e){return t._show(i,s),n.shortLink&&n.shortLink==="click"&&!Q.socShare.acc.shortLinks.sms&&Q.socShare.acc.getShortLink(n,function(){n.href=Q.socShare.acc.getHref(n),Q.socShare.g("bd_share_mediaes_mail",i).href=n.href.mail,Q.socShare.g("bd_share_mediaes_sms",i).href=n.href.sms}),!1},t._layClickHandler=function(e){var n=window.event?window.event.srcElement:e.target;return n===this.getElementsByTagName("td")[0]&&t._hide(i,s),!1},t._closeBtnClickHandler=function(e){return setTimeout(function(){t._hide(i,s)},10),!1},e||(Q.socShare.on(window,"orientationchange",t._viewOrientHandler),Q.socShare.on(n.dom_id,"click",t._shareBtnClickHandler)),Q.socShare.on("bd_share_popup_close_"+r,"click",t._closeBtnClickHandler),Q.socShare.on("bd_share_popup_content","click",t._layClickHandler)},_remove_event:function(e){var t=this,n=t._data,r=n.time;Q.socShare.un(window,"orientationchange",t._viewOrientHandler),Q.socShare.un(n.dom_id,"click",t._shareBtnClickHandler),Q.socShare.un("bd_share_popup_close_"+r,"click",t._closeBtnClickHandler),Q.socShare.un("bd_share_popup_content","click",t._layClickHandler)},_hide:function(e,t){t===!0?e.style.display="none":e.style.display="none"},_show:function(e,t){t===!0?e.style.display="":e.style.display=""},_slide:function(e,t){var n=Q.socShare.g("bd_share_popup"),r=n.offsetHeight,i;e==="up"?(n.style.height=0,i=function(e){return r-inc*r/total+"px"}):i=function(e){return inc*r/total+"px"};var s=function(){if(typeof document.body.style.webkitTransition)return function(){n.style.height=e==="up"?0:r+"px",n.style.overflow="hidden",n.style.webkitTransition="height linear .3s";var i=function(){n.style.height="auto",n.style.overflow="auto",n.style.webkitTransition="none",t&&t(),n.removeEventListener("webkitTransitionEnd",i,!1)};n.addEventListener("webkitTransitionEnd",i,!1),setTimeout(function(){n.style.height=e==="up"?r+"px":0},0)};var o=inc=15;return function(){inc--,n.style.height=i(inc),inc>0?setTimeout(s,30):(t&&t(),n.style.height="auto")}}();s()},_orient:function(){var e=this,t=this._data;return delete t.afterInit,e._orientTimer&&clearTimeout(e._orientTimer),e._orientTimer=setTimeout(function(){e.render(t,!0)},500),!1},_popup_render:function(){var e=this._data,t=Q.socShare.g("bd_share_popup_"+e.time);t||(t=document.createElement("div"),t.style.display="none",t.id="bd_share_popup_"+e.time),t.innerHTML=this._template('<div class="bd-share-popup-layer" id="bd_share_popup_layer" style="height:<%=(pageHeight+500)%>px;"></div><div class="bd-share-pop-content <%=theme%>" id="bd_share_popup_content" style="height:<%=pageHeight%>px;"><table><tr><td><div class="bd-share-popup" id="bd_share_popup" style="width:<%=popupWidth%>;">'+this._tpl+'<div class="bd-share-popup-footer"><a class="bd-share-popup-close" id="bd_share_popup_close_<%=time%>" href="javascript:void 0;">\u53d6\u6d88</a></div></div></div></td></tr></table>',e),document.body.appendChild(t)},close:function(){var e=this._data;if(e){var t=Q.socShare.g("bd_share_popup_"+e.time);t&&this._hide(t)}},destroy:function(){var e=this._data;if(e){var t=Q.socShare.g("bd_share_popup_"+e.time);this.close(),this._remove_event(),t&&Q.socShare.dom.remove(t)}},render:function(e,t){this._data=e;var n=this;if(e&&e.afterInit&&typeof e.afterInit=="function")e.afterInit(e.href);else{e.theme=e.theme||"web";var r=Q.socShare.dom.getPageSize();e.pageHeight=r.WinH,e.theme==="native"?(e.popupWidth="100%",e.listWidth=r.WinW-r.WinW%76+"px"):(e.listWidth="100%",e.popupWidth=r.WinW-r.WinW%76+"px");if(!t){this._addStyle();var i=e.afterRender}this._popup_render(),this._add_event(t),i&&typeof i=="function"&&i()}}}),function(){window.afterGetShortLink=function(e){e.mail=e.email,Q.socShare.acc.shortLinks=e},Q.socShare.lang.module("Q.socShare.acc",{shortLinks:{},_order:[],_defaultOrder:["sms","qzone","sinaminiblog","qqmb","renren","kaixin001","mail"],_mediaes:{sms:{media_type:"sms",cn:"\u77ed\u4fe1",selected:!1},qzone:{media_type:"qzone",cn:"QQ\u7a7a\u95f4",selected:!1},sinaminiblog:{media_type:"sinaminiblog",cn:"\u65b0\u6d6a\u5fae\u535a",selected:!1},qqmb:{media_type:"qqmb",cn:"\u817e\u8baf\u5fae\u535a",selected:!1},renren:{media_type:"renren",cn:"\u4eba\u4eba\u7f51",selected:!1},kaixin001:{media_type:"kaixin001",cn:"\u5f00\u5fc3\u7f51",selected:!1},mail:{media_type:"mail",cn:"\u90ae\u4ef6",selected:!1}},getShortLink:function(e,t){var n=this,r="&url="+e.url+"&client_type=web&media_types=email,sms&callback=afterGetShortLink",i="http://api.bshare.cn/share/";Q.socShare.sio.callByBrowser(i+"?"+r,function(r){n.afterGetShortLink(e,t)})},afterGetShortLink:function(e,t){var n=this.shortLinks;e.shortLinks=n,t&&t()},getEmailHref:function(e,t){var n="";if(Q.socShare.isIPhone()){var r=e.replace(/&/g,"&amp;");n=encodeURIComponent(r+"   ")+t}else if(Q.socShare.isAndroid()){var i=Q.socShare.getBrowserInfo();i.baidu?n=encodeURIComponent(e+"   ")+t:n=e,n=encodeURIComponent(n)}else{var s=e.replace(/&/g,"%26");n=s}return"mailto:someone@somedomain.com?body="+n},getSMSHref:function(e,t){var n="",r=Q.socShare.getBrowserInfo();return n=encodeURIComponent(e+" \u731b\u6233\uff1a")+t,"sms:?body="+n},getQQHref:function(e){var t=e.url||"",n=encodeURIComponent(e.appname||"360\u5f69\u7968");return["http://openmobile.qq.com/oauth2.0/m_jump?page=qzshare.html&loginpage=loginindex.html&logintype=qzone","&site="+n,"&appName="+n,"&summary="+encodeURIComponent(e.content?e.content:" "),"&title="+encodeURIComponent(e.title?e.title:" "),"&appId=100312028","&action=shareToQQ","&targetUrl="+t,e.pic_url?"&imageUrl="+e.pic_url:"","&t="+(new Date).getTime()].join("")},getHref:function(e){var t=e.content||"",n=e.pic_url||"",r=e.url||"",i=e.u||e.url,s=e.title,o=encodeURIComponent(this._order.join(","));t.length>300&&(t=t.substring(0,300));var u={},a=this;return Q.socShare.each(e.mediaes,function(i,l){var p="";switch(i.media_type){case"mail":p=a.getEmailHref(t,a._getUrl(e,"mail"));break;case"sms":p=a.getSMSHref(t,a._getUrl(e,"sms"));break;case"qzone":p=a.getQQHref(e);break;default:p="http://api.bshare.cn/share/"+i.media_type+"?url="+r+"&summary="+encodeURIComponent(t)+"&pic="+n,!e.afterInit&&(p+="&enabled_medias="+o),s&&(p+="&title="+encodeURIComponent(s))}u[i.media_type]=p}),u},_getMedia:function(e){if(e==="sms"&&Q.socShare.isIPhone())return null;var t=Q.socShare.acc._mediaes;return t[e]},_filterMediaesOrder:function(e){var t=[],n=Q.socShare.acc._mediaes;if(e&&!!e.length)for(var r=0,i=e.length;r<i;r++){var s=e[r];n[s].selected=!1,n[s]&&!n[s].selected&&(t.push(s),n[s].selected=!0)}return!t.length&&(t=this._defaultOrder),t},_getShowMediaes:function(e){this._order=[],e=this._filterMediaesOrder(e);var t=[];for(var n=0,r=e.length;n<r;n++){var i=e[n],s=this._getMedia(i);s&&((i!=="sms"||i!=="mail")&&this._order.push(i),t.push(s))}return t},_render:function(e){Q.socShare.ui.render(e)},_getUrl:function(e,t){var n=e.shortLinks||{};return n[t]||e.url},init:function(e){var t=this;e.time=(new Date).getTime(),e.mediaes=this._getShowMediaes(e.order);var n=function(e){e.href=t.getHref(e),t._render(e)};e.shortLink&&e.shortLink==="init"?this.getShortLink(e,function(){n(e)}):n(e)}})}(),function(){function t(e){return e.replace(/[^\x00-\xff]/g,"ci").length}function n(e,n,r){if(n<0||t(e)<=n)return e.valueOf();var i=e.substr(0,n).replace(/([^\x00-\xff])/g,"$1 ").substr(0,n).replace(/[^\x00-\xff]$/,"").replace(/([^\x00-\xff]) /g,"$1");return i+(r||"")}var e=Q.socShare;e.init=function(t){if(!t&&typeof t!="object")return alert("\u8bf7\u53c2\u7167\u6587\u6863\u586b\u5199\u4e2a\u914d\u7f6e\u5427"),!1;if(!t.afterInit&&!e.g(t.dom_id))return alert("\u627e\u4e0d\u5230\u60a8\u914d\u7f6e\u89e6\u53d1\u6d6e\u5c42\u7684dom\u8282\u70b9"),!1;t&&!t.url&&(t.url=encodeURIComponent(location.href)),t.content&&(t.content=n(t.content,300,"...")),e.acc.init(t)},e.close=function(){e.ui.close()},e.destroy=function(){e.ui.destroy()}}()})();